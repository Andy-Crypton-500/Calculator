<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Flip Card Calculator</title>
    <link
      rel="icon"
      type="image/x-icon"
      href="/Math_programming_calc_figure_2_half_column_mobile.jpg"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />
    <style>
      body {
        margin: 0;
        background-image: url("/pao-pattarapol-rf4IuDOfyEU-unsplash.jpg");
        background-size: cover;
        background-position: center;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      /* Wrapper that handles centering */
      #app {
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .flip-card {
        width: 500px;
        height: 300px;
        perspective: 1000px;
        cursor: pointer;
      }

      .flip-card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        transition: transform 0.6s;
        transform-style: preserve-3d;
        border-radius: 20px;
      }

      .flip-card.flipped .flip-card-inner {
        transform: rotateY(180deg);
      }
      .flip-card {
        perspective: 1500px;
      }
      .flip-card-inner {
        transform-style: preserve-3d;
        transition: transform 0.8s ease-in-out;
      }
      .flip-card:hover {
        animation: zoom 0.4s ease-in-out;
      }

      @keyframes zoom {
        0% {
          transform: scale(1);
        }
        25% {
          transform: scale(1.1);
        }
        50% {
          transform: scale(1.15);
        }
        75% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }
      .flip-card-front,
      .flip-card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 20px;
        color: white;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        background: rgba(255, 255, 255, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        backface-visibility: hidden;
        text-align: center;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 1rem;
        box-sizing: border-box;
      }

      .flip-card-back {
        transform: rotateY(180deg);
      }

      #buttons {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        align-items: center;
        padding-top: 10px;
        color: white;
      }

      button {
        padding: 0.6rem 1.2rem;
        border: none;
        border-radius: 8px;
        background-color: rgba(255, 255, 255, 0.2);
        color: white;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      button:hover {
        background-color: rgba(255, 255, 255, 0.4);
      }
      #nav {
        width: 100%;
        height: 70px;
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 2rem;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 1000;
        color: white;
        font-weight: bold;
        font-size: 1.2rem;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        border-top-left-radius: 0;
        border-top-right-radius: 0;
      }
      #link {
        text-decoration: none;
        transition: color 0.3s ease;
        color: white;
        padding-left: 20px;
      }
      #link:hover {
        color: #ffd700;
      }
      #about {
        position: absolute;
        right: 460px;
        bottom: 24px;
      }
      #login {
        position: absolute;
        right: 560px;
        bottom: 24px;
      }
      #contact {
        position: absolute;
        right: 340px;
        bottom: 24px;
      }
      #game {
        position: absolute;
        right: 240px;
        bottom: 24px;
      }
      #username-display {
        position: absolute;
        right: 100px;
        bottom: 24px;
      }

      /* Dropdown for username */
      .user-dropdown {
        position: relative;
        display: inline-block;
        color: rgb(255, 255, 255);
      }

      .user-dropdown .dropbtn {
        cursor: pointer;
        user-select: none;
      }

      /* Hide dropdown content by default */
      .user-dropdown .dropdown-content {
        display: none;
        position: absolute;
        margin-top: 10px;
        background-color: rgba(218, 142, 20, 0.95);
        min-width: 140px;
        border-radius: 6px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        right: 0;
        z-index: 1001;
      }

      .user-dropdown .dropdown-content a {
        color: #333;
        padding: 10px 14px;
        text-decoration: none;
        display: block;
      }

      .user-dropdown .dropdown-content a:hover {
        background-color: #eee;
      }

      /* Show dropdown when .open class is added */
      .user-dropdown.open .dropdown-content {
        display: block;
      }

      .white-links a,
      .white-links a:visited {
        color: white !important;
        font-weight: bold;
        font-size: 1.2rem;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        text-decoration: none;
      }
    </style>
  </head>
  <body>
    <div id="nav">
      <div><a href="index.html" id="link">My Calculator</a></div>
      <div>
        <a
          href="login.html"
          style="margin-right: 20px; color: white; text-decoration: none"
          id="login"
          >Login</a
        >
        <a href="#" style="color: white; text-decoration: none" id="about"
          >About</a
        >
        <a href="contract.html" style="color: white; text-decoration: none" id="contact"
          >Contract</a
        >
        <a href="game.html" style="color: white; text-decoration: none" id="game"
          >Game</a
        >
        <span id="username-display"></span>
      </div>
    </div>

    <div id="app">
      <div class="flip-card" onclick="this.classList.toggle('flipped')">
        <div class="flip-card-inner">
          <div class="flip-card-front">
            <h1>Welcome to My Calculator!</h1>
            <h3>The one and only scientific/graphing calculator!</h3>
            <small>Click to continue</small>
          </div>
          <div class="flip-card-back">
            <div id="buttons">
              <button id="scientific">Scientific Calculator</button>
              <button id="graphing">Graphing Calculator</button>
              <button id="calculus">Derivative/Integral Calculator</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const username = localStorage.getItem("loggedInUser");
      const usernameDisplay = document.getElementById("username-display");
      const loginLink = document.getElementById("login");

      if (username && usernameDisplay) {
        usernameDisplay.innerHTML = `
          <div class="user-dropdown">
            <span class="dropbtn"> <i class="bi bi-person-fill"></i> Hello, ${username} â–¼</span>
            <div class="dropdown-content">
              <a href="#" id="logout">Logout</a>
            </div>
          </div>
        `;

        document.getElementById("about").style.right = "620px";
        document.getElementById("contact").style.right = "500px";
        document.getElementById("game").style.right = "400px";
        document.getElementById("username-display").style.right = "100px";

        const nav = document.getElementById("nav");
        nav.classList.add("white-links");

        if (loginLink) {
          loginLink.style.display = "none";
        }

        // Dropdown delay logic
        const userDropdown = document.querySelector(".user-dropdown");
        let timeoutId;

        userDropdown.addEventListener("mouseenter", () => {
          clearTimeout(timeoutId);
          userDropdown.classList.add("open");
        });

        userDropdown.addEventListener("mouseleave", () => {
          timeoutId = setTimeout(() => {
            userDropdown.classList.remove("open");
          }, 300); // 1 second delay after mouse leaves
        });

        // Logout click handler
        document.getElementById("logout").addEventListener("click", function () {
          logOut();
          usernameDisplay.innerHTML = `<a href="login.html" style="color: white; text-decoration: none"><i class="bi bi-person-circle"></i> Sign In: </a>`;
          loginLink.style.display = "inline";
          document.getElementById("about").style.right = "460px";
          document.getElementById("login").style.right = "560px";
          document.getElementById("contact").style.right = "340px";
          document.getElementById("game").style.right = "240px";
          document.getElementById("username-display").style.right = "100px";
          const nav = document.getElementById("nav");
          nav.classList.add("white-links");
        });
      } else {
        usernameDisplay.innerHTML = `<a href="login.html" style="color: white; text-decoration: none" title:"Save your computations"><i class="bi bi-person-circle"></i> Sign In: </a>`;
      }

      function confirmRedirect(title, text, url) {
        Swal.fire({
          title: "Are you sure you want to leave? You won't be able to return!",
          text: text,
          icon: "warning",
          showCancelButton: true,
          confirmButtonColor: "#3085d6",
          cancelButtonColor: "#d33",
          confirmButtonText: "Yes!",
        }).then((result) => {
          if (result.isConfirmed) {
            Swal.fire({
              title: "Redirecting...!",
              icon: "success",
              timer: 1000,
              showConfirmButton: false,
            });
            setTimeout(() => (window.location.href = url), 1000);
          }
        });
      }

      document.getElementById("scientific").addEventListener("click", () =>
        confirmRedirect(
          "Scientific Calculator",
          "You will be redirected to the scientific calculator",
          "scientific.html"
        )
      );
      document.getElementById("graphing").addEventListener("click", () =>
        confirmRedirect(
          "Graphing Calculator",
          "You will be redirected to the graphing calculator",
          "graph.html"
        )
      );
      document.getElementById("calculus").addEventListener("click", () =>
        confirmRedirect(
          "Derivative and Integral Calculator",
          "You will be redirected to the derivative/integral calculator",
          "derivative.html"
        )
      );

      function logOut() {
        localStorage.removeItem("loggedInUser");
        Swal.fire({
          icon: "success",
          title: "You have been logged out!",
          timer: 1000,
          showConfirmButton: false,
        });
      }
    </script>
  </body>
</html>
